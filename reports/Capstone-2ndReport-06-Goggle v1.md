# Team-Info
| (1) 과제명 | LangChain 기반 AI 바둑 복기(復棋) 서비스:<br> 중급자 실력 향상을 위한 맞춤형 LLM해설 지원
|:---  |---  |
| (2) 팀 번호 / 팀 이름 | 06-Goggle |
| (3) 팀 구성원 | 한사랑 (2271064): 리더, PM, AI <br> 김희서 (2276093): 팀원, Back-end <br> 임가현 (1948072) : 팀원, Front-end		 |
| (4) 팀 지도교수 | 심재형 교수님 |
| (5) 과제 분류 | 산학과제 |
| (6) 과제 키워드 | 바둑, 복기, KataGo, LangChain, SGF |
| (7) 과제 내용 요약 | **바둑 AI엔진, 생성형 AI, SGF-Analyze** 오픈소스를 통합하여, 사용자가 업로드한 SGF 포맷의 바둑 기보를 분석 및 자동으로 해설을 생성하고 복기(復棋)를 지원하는 시스템 구축. |

<br>

# Project-Summary
| 항목            | 내용   |
| :--- | --- |
| (1) 문제 정의 | <br>**AI 바둑 복기, 왜 아직도 어려울까요?**<br><br>바둑이 끝난 뒤의 **복기**(復棋)는, 마치 **오답노트를 정리하듯** 실력 향상을 위한 핵심 단계입니다. <br>하지만 아마추어 바둑 팬들에게 복기는 여전히 만만치 않은 과제입니다.<br><br>AI의 도움을 받아 **객관적인 분석과 개선점**을 얻고자 하는 수요는 분명 존재하지만, <br>기존 AI 복기 서비스는 **사용이 어렵거나 실질적인 도움이 되지 않는 경우가 많습니다.**<br><br> --- <br><br>**Target Customer**: *중~고급 기력의 아마추어 바둑팬*<br><br>- 타이젬 18급 이상, 복기를 통해 **실질적 기력 향상**을 원하는 사용자<br>    - 맞춤형 바둑 **AI 해설**에 대한 need를 가진 사용자<br>    - 자신의 기보를 체계적으로 **아카이빙**하려는 need를 가진 사용자<br><br> --- <br><br>**Pain Points**:<br><br>**1. 셀프 복기는 어렵고, 전문가의 도움은 비싸다**<br>- 바둑을 되돌아보는 과정은 많은 시간과 집중력을 요함.<br>- 전문가에게 받는 코칭은 비용 부담이 크고, 꾸준히 받기 어려움.<br><br>**2. 기존 AI는 너무 어렵고, 접근성이 떨어진다**<br>- 기존 바둑 AI 프로그램은 설치와 설정이 복잡하고, 컴퓨터에 대한 고수준 지식도 필요함.<br>- 대부분의 서비스는 수치나 그래프 중심의 정보만 제공하여 실질적인 이해로 이어지기 어려움.<br><br>**3. 사용자 경험이 불편해서, 결국 안쓰게 된다**<br>- 기보 파일을 올리는 것도 번거롭고, 분석 결과를 보는 화면이 직관적이지 않은 경우가 많음.<br>- 중요한 장면을 다시 찾아보기도 어렵고, 원하는 기능을 찾는 데 시간이 걸림. <br><br>✔️ 수정사항: 기존 문장의 가독성을 향상하였고, 목표 관련 문장은 삭제하였습니다. |
| (2) 기존 연구와의 비교 | ![Image](https://github.com/user-attachments/assets/4cee6fc6-2de1-4025-b1e3-dc15e82da091) <br><br>**🔍 기존 서비스 분석**<br><br>**1. 웹 기반 바둑 플랫폼 (타이젬, 오로 등)**<br>**강점:** 설치 없이 사용 가능하며, 대국과 커뮤니티 기능에 강점<br>**한계:** AI 해설은 유료에 한정되거나 피상적인 경우가 많고, 학습 목적의 개인화 기능은 부족함<br>    <br>**2. 로컬 설치형 분석 도구 (Sabaki, KaTrain 등)**<br>**강점:** Katago 기반의 정밀한 분석 제공. 기보 편집에 최적화<br>    **한계:** 설치와 세팅이 복잡하고, 자연어 해설이나 온라인 접근성, 개인화 기능이 제한적<br>    <br>**📍 본 과제의 차별성**<br><br>- **웹 기반의 접근성과 AI 분석을 결합**해 기존 도구의 한계를 극복<br>    - **LLM 기반 자연어 해설**로 중급자 눈높이에 맞춘 복기 제공<br>- **기보 아카이빙, 편집 기능**으로 간편한 기보 아카이빙 기능 지원<br>    - **바둑 학습에 집중된 UX**로 실력 향상에 최적화된 환경을 지향<br><br>**WireFlow** <br><br>![Image](https://github.com/user-attachments/assets/18f74807-9855-435d-997e-28f2bea0bbe6)<br><br> 이러한 Idea를 기반으로 진입점, 메인, 핵심 기능이 담긴 **WireFlow**를 제작하였습니다. <br><br>✔️ 수정사항: 기존 줄글로 된 서비스 분석을 도표로 대체했습니다. 또한 차별화 포인트는 글로 보완했습니다. wireflow를 추가하였습니다. |
| (3) 제안 내용 | ![Image](https://github.com/user-attachments/assets/d0521d8d-72d1-41bf-8825-0c88a9a4ed0d)<br><br> **제안 내용**<br>저희는 위에서 제시한 Pain Points를 해결하기 위해,<br>**Katago, 생성형 AI(LLM), SGF-Analyze 오픈소스**를 통합한 **웹 기반 AI 복기 시스템**을 제안합니다.<br><br>**Key Idea**<br>- **Katago 기반의 기보 분석** → 성능이 뛰어난 AI 엔진으로 정확하고 깊이 있는 복기 제공<br>- **LangChain + LLM 자연어 해설 생성** → 수치가 아닌, 이해하기 쉬운 **맞춤형 해설** 제공으로 복기 시간/비용 절감<br>- **SGF 파일 분석 및 아카이빙 기능** → 사용자는 자신의 기보를 **저장하고 다시 불러와 학습**할 수 있음<br>    - **직관적인 웹 UI 기반 복기 도구(SGF 에디터)** → 기보 업로드, 분석 확인, 하이라이트 확인 등을 손쉽게 수행<br><br>**기술 스택**<br>- 바둑 AI 오픈소스: [KataGo](https://github.com/lightvector/KataGo)<br> - SGF 분석 오픈소스: [sgf-analyze](https://github.com/9beach/analyze-sgf), [sgf parser](https://github.com/SabakiHQ/sgf)<br> - Front-end: Next.js + TypeScript + Vercel<br> - Back-end: Nest.js + MongoDB<br>  - AI: LangChain, Python<br> - LLM: GPT4o<br><br> ✔️ 수정사항: idea 이미지 추가, 기존 설명을 더 쉽고 가독성 있는 문구로 대체 |
| (4) 기대효과 및 의의  | 사용자 맞춤형 바둑 학습 지원: AI 기반의 자동 해설로 중고급자의 수준에 맞는 복기 지원, 실력 향상에 기여.<br> - 시간 절약 및 편의성 향상: 복잡한 분석 과정을 자동화하여 더 쉽게 바둑을 분석하고 해설을 얻을 수 있음. <br> - 연구 및 교육 자료 지원: 다양한 기보 데이터와 AI 해설을 통해 바둑 연구 및 교육의 자료로 활용할 수 있는 가능성|
| (5) 주요 기능 리스트  | **주요 기능**<br><br>**1. 기보 아카이빙 기능**<br>- 사용자의 학습 편의성과 데이터 연속성을 보장하는 기능입니다.<br>- 사용자는 자신의 컴퓨터에 있는 SGF 파일을 서비스에 업로드하여 분석할 수 있습니다.<br>- 분석이 완료된 기보(AI 분석 결과 및 생성된 해설 포함)는 사용자 계정에 안전하게 저장되어, 언제든지 목록에서 다시 불러와 복기를 이어가거나 관리할 수 있습니다.<br>- 이는 사용자가 자신의 학습 기록을 체계적으로 관리하고 필요할 때 다시 참조할 수 있게 합니다.<br><br>**2. SGF 기보 에디터 기능**<br>- 사용자가 불러온 기보를 자유롭게 편집할 수 있는 기능입니다.<br>- 사용자는 중요한 장면에 mark를 남겨 중요한 수를 시각적으로 강조할 수 있습니다.<br>    - 수를 놓는 순서에 따라 자동으로 game tree가 구성되며, 분기나 다양한 진행 가능성을 자연스럽게 탐색할 수 있습니다.    <br>- 각 수에 대해 **텍스트 코멘트를 남기는 기능**도 제공되어, 사용자 본인의 생각이나 AI 해설에 대한 이해를 기록하는 데 활용됩니다.<br><br>**3. SGF 기보 분석 기능**<br>- 사용자가 업로드한 SGF 기보를 AI(Katago 엔진)를 이용해 자동으로 분석하는 핵심 기능입니다.<br>- '분석하기' 요청 시, 서버는 기보 데이터를 처리하여 AI 엔진에 전달하고, 엔진은 각 수의 승률 변화, 추천 수, 예상 진행 등을 계산합니다.<br>- 이 분석 결과는 해설 생성 및 하이라이트 기능의 기반 데이터로 활용되며, 사용자는 이를 통해 자신의 대국을 객관적으로 평가하고 개선점을 찾을 수 있습니다.<br><br>**4. AI 하이라이트 해설 기능**<br>- AI 분석 결과를 바탕으로 게임의 흐름과 핵심 내용을 쉽게 파악하도록 돕는 기능입니다.<br>- 승률 변화가 급격했던 주요 장면(예: 결정적 실수, 좋은 수, 승부처)을 시스템이 자동으로 감지하여 기보 위에 시각적으로 하이라이트하여 표시합니다. 동시에, 해당 장면에 대해 LangChain과 LLM을 활용하여 생성된 자연어 해설을 함께 제공합니다.<br>- 이를 통해 사용자는 중요한 순간을 놓치지 않고, '왜' 그 수가 중요했는지에 대한 구체적인 설명을 통해 학습 효과를 극대화할 수 있습니다.<br><br>✔️ 수정사항: 로그인 및 사용자 인증 관련 기능은 주요 기능이 아니므로 제거했습니다.|

<br>
 
# Project-Design & Implementation
| 항목  | 내용   |
| :--- | ------ |
| (1) 요구사항 정의  | ![Image](https://github.com/user-attachments/assets/c3e0d82b-5fb0-4e88-b364-32470d433eba) ![Image](https://github.com/user-attachments/assets/85adf532-b9f5-4ab1-b676-956d614e03d6)  |
| (2) 전체 시스템 구성    | <br> **시스템 아키텍처** <br><br> ![Image](https://github.com/user-attachments/assets/90e061f5-3aa3-4508-89ea-08ecb1866b2b) <br><br>본 시스템은 SGF 바둑 기보를 기반으로 **AI 기보 분석**, **LLM 해설 생성**, **시각화된 복기**를 통합 제공하는 웹 기반 서비스입니다. 각 모듈은 독립적으로 설계되어 있고, Next.js 기반 프론트엔드가 중심이 되어 백엔드 API 및 분석/해설 모듈과 유기적으로 연동됩니다.<br><br>**데이터 흐름 및 모듈 간 통합 방식**<br><br>1. **사용자 인터랙션 (GUI 모듈)**<br>    - 사용자는 Vercel에 배포된 Next.js 기반 웹 앱에 접속하여 SGF 파일을 업로드하거나 기존 기보를 선택합니다.<br>	업로드된 기보는 Next.js의 API 라우트를 통해 백엔드로 전달되며, 이후 전체 분석 프로세스가 트리거됩니다.<br>        <br>    <br>2. **비즈니스 로직 처리 (Backend Worker)**<br>    - Next.js API 라우트는 백엔드 워커 컨테이너(Run on Render)에 분석 요청을 전달합니다.        <br>    - 백엔드는 SGF의 유효성을 검증하고, 분석 요청을 KataGo 모듈에 전달합니다.<br>        <br>    <br>3. **기보 분석 (AI 분석 모듈)**<br>    - KataGo는 SGF 수순에 따라 각 착수 지점의 승률, 예상 수, 점수 차이를 계산합니다.<br>    - 결과는 JSON 형태로 백엔드에 반환되며, 이 중 의미 있는 변화가 있는 수순만 필터링됩니다.<br>        <br>    <br>4. **LLM 해설 생성 (LangChain 모듈)** <br>    - 필터링된 하이라이트 수순 및 KataGo 결과는 LangChain 모듈에 전달됩니다.   <br>    - LangChain은 GPT-4와 통신하여, 각 중요 수순에 대한 해설을 생성합니다.  <br>    - 생성된 자연어 해설은 다시 백엔드로 전달되어 사용자 계정에 저장됩니다.<br>        <br>    <br>5. **데이터 저장 및 복기 지원 (기보 아카이빙 모듈)**   <br>    - 모든 분석 결과 및 해설은 PostgreSQL 기반 데이터베이스에 사용자별로 저장됩니다.    <br>    - 사용자는 언제든지 기보 목록을 조회하고, 특정 기보를 불러와 복기를 이어갈 수 있습니다.<br>        <br>    <br>6. **시각화 및 해설 노출 (GUI 모듈)**<br>    - 분석이 완료되면 프론트엔드는 바둑판 위에 승률 그래프, 중요 수순 마커, 해설 텍스트를 함께 렌더링합니다.     <br>    - 사용자는 수를 따라가며 직접 복기하고, 중요 수에 마킹하거나 메모를 남길 수 있습니다. <br><br>✔️ 수정사항: 기존에 없었던 전체 시스템 구조에 대한 설명과 모듈 통합 흐름을 추가했습니다.|
| (3) 주요엔진 및 기능 설계 | **🔧 주요 모듈 설명**<br><br>**1. GUI 모듈 (Frontend: Next.js + Vercel) - 95% 완료**<br><br>**기능 및 역할**: 사용자가 웹에서 바둑 복기 서비스를 직관적으로 이용할 수 있도록 하는 인터페이스를 제공함. SGF 파일 업로드, 기보 시각화, 분석 결과 확인, 해설 열람 등의 주요 사용자 흐름을 담당.<br>    <br>**구현 방식**<br>    - Next.js 프레임워크 기반의 CSR + SSR 혼합 구조를 사용함.<br>        SGF 기보 파일은 react-sgf와 커스텀 컴포넌트를 조합해 바둑판 형태로 시각화되며, 사용자는 수순을 따라가거나 중요한 수에 마크 및 코멘트를 남길 수 있음.<br>        - API 요청은 Next.js API routes를 통해 백엔드 서버와 통신하며, 분석 요청 및 결과 데이터를 동기화함.<br>		- 배포 및 호스팅은 Vercel을 활용.<br><br><br>**2. AI 분석 모듈 (KataGo + Analyze-sgf) - 90% 완료**<br><br>**기능 및 역할**: 사용자가 업로드한 기보(SGF)를 기반으로 KataGo 엔진을 이용해 승률 변화, 최선 수, 착수 실수 등을 분석.<br>    <br>**구현 방식**<br>- Docker 환경에서 KataGo 엔진과 analyze-sgf CLI 도구를 함께 실행하여, SGF를 입력하면 JSON 형태의 분석 결과를 반환함.<br>- 분석 요청은 백엔드 워커가 수신하며, SGF 파일을 임시 저장 후 분석을 수행하고, 결과는 구조화된 데이터로 정제되어 LangChain 모듈로 전달됨.<br>- KataGo의 설정 값은 서버 리소스에 맞게 조절하여 구성됨.<br><br><br>**3. 해설 생성 모듈 (LangChain + GPT-4) - 100% 완료**<br><br>**기능 및 역할**: KataGo의 분석 결과를 바탕으로, 사용자가 이해하기 쉬운 자연어 해설을 자동 생성.<br>    <br>**구현 방식**<br>    - LangChain을 사용해 프롬프트 템플릿, 분석 정보 요약, LLM 호출 로직을 구성함.<br>    - KataGo 분석 결과(예: 승률 하락 구간, 실착 위치)를 기준으로, 특정 수에 대한 분석 포인트를 정제하고, GPT-4 API에 전달할 프롬프트를 자동 생성함.<br>    - ChatGPT 4.0 API를 호출한 후, 응답 받은 해설은 json 포맷으로 가공되어 사용자에게 전달됨.<br><br><br>**4. 기보 아카이빙 모듈 (Backend + Database) - 50% 완료**<br><br>**기능 및 역할**: 사용자 기보 및 해설 데이터를 안전하게 저장하며, 언제든지 복기나 재학습을 이어갈 수 있도록 지원함.<br>    <br>**구현 방식**<br>    - Render 플랫폼 위에서 Docker 기반의 Backend Worker가 비동기 처리 작업(KataGo 분석, LangChain 호출)을 담당함.        <br>    - PostgreSQL DB에 사용자 계정, 업로드된 SGF, KataGo 분석 기보, 생성된 해설 등을 정규화된 테이블로 저장하여 관리함.<br>    - 사용자 계정마다 기보 목록을 분리하여 조회 및 삭제 기능을 지원.<br>	- *현재 GUI 모듈의 일부 기능이 아직 수정중이므로 본격적인 연결이 이루어지지 않음.* |
| (4) 주요 기능의 구현  | **1. SGF 기보 에디터 기능 구현** ![Image](https://github.com/user-attachments/assets/973d22d1-b2ce-4255-b102-e4dd3d87eb5b) <br> (1) SAVE: 현재 기보를 SGF로 저장 <br> (2) Marker, Memo: 각 수순에 종속된 마커 표시와 사용자 메모도 함께 SGF에 저장됨  ![Image](https://github.com/user-attachments/assets/d0677c82-2c55-4400-a48a-92345b2797a7) <br> (3) OPEN: SGF 형식의 기보 불러오기 <br> (4) Gametree: 다양한 경우의 수로 시뮬레이션한 기보를 branch 형식으로 시각화 ![Image](https://github.com/user-attachments/assets/6b7d1f51-e144-463c-872f-112a43ed6362) <br> (5) Boardmatcher: 바둑 패턴을 인식하여 관련 설명 링크(Sensei’s Library)로 연결<br><br>**2. LLM 기반 해설 생성 기능 구현**<br><br>![Image](https://github.com/user-attachments/assets/81d5b145-ab5c-4632-a922-87285073c39d) <br>해당 기능의 구현을 위해서 **AI 분석 모듈**과 **해설 생성 모듈**이 통합되어야 합니다.<br>이를 위해 LangChain과 GPT model을 연결하고, KataGo 엔진과 연결된 Analyze-sgf 라이브러리를 Python 스크립트로 연결하여 자동화하였습니다.<br><br>**해설 생성 프로세스:** <br><br> ![Image](https://github.com/user-attachments/assets/c40d8975-a663-4fb0-b7d4-8ecb9b1d761e)<br><br> - **(선행)** Katago 분석 완료 후, 분석 결과를 저장함.<br> <br>**1. 트리거 및 데이터 준비(Python subprocess):**<br> - Katago 분석 완료 후 또는 사용자 요청 시 트리거됨.<br> - **Katago 분석 결과** 및 **하이라이트 정보** 로드함.<br><br> **2. LangChain 처리 (해설 생성 Module):** <br><br> ![Image](https://github.com/user-attachments/assets/4d1c86fc-eb7e-4d4f-aede-9c23d3daa9fe)<br><br> - 준비된 데이터를 LangChain 모듈에 전달함.<br> - LangChain 내부에서 `PromptTemplate`을 사용하여 LLM(GPT-4)에 전달할 프롬프트 동적 구성함. (템플릿 내 분석 결과, 해설 지침 등 포함)<br> - LLM 모델(`ChatOpenAI`) 객체 초기화 및 실행할 Chain 정의함.<br> <br>**3. LLM API 호출 및 응답 처리 (LangChain -> GPT-4 API):**<br><br> ![Image](https://github.com/user-attachments/assets/6cd58535-9f5e-485f-97b7-f45c8667c287)<br><br> - LangChain이 구성된 프롬프트로 GPT-4 API 호출.<br> - LLM이 생성한 **자연어 해설 텍스트** 응답 받음.<br> - LangChain/API 서버가 응답 텍스트 후처리하여 최종 해설 하이라이트 객체 생성 후 반환. |
| (5) 기타   | -  |
